{"pageProps":{"postData":{"id":"content_sign","contentHtml":"# content\\_sign\n\n## 問題文\n\nどうやら、この画像には署名技術を使っているらしい。この署名技術は、画像に対しての編集を記録することができるらしい。署名技術を特定し、改変前の画像を復元してほしい。 Flag形式はTsukuCTF23{<一個前に署名した人の名前>&<署名した時刻(ISO8601拡張形式)>}です。例えば、一個前に署名した人の名前は「Tsuku」で、署名した時刻が2023/12/09 12:34:56(GMT+0)の場合、フラグはTsukuCTF23{Tsuku&2023-12-09T12:34:45+00:00}です。なお、タイムゾーンはGMT+0を使用してください。\n\nIt seems this image is applied digital signature, which can record edit history for an image.\nIdentify the technology and restore the raw image, which means the image before revised.\n\nThe flag format is TsukuCTF23{<the name of the previous signing person>&\\<signed time(ISO8601 extended format)>}\n\n## 難易度\n\nmedium\n\n## 解法\n\nexiftool -verbose signed\\_flag.png\n上記コマンドを叩くと、下記のような出力が返ってくる。\n\n```\nPNG IHDR (13 bytes):\n[BinaryData directory, 13 bytes]\n| ImageWidth = 3024\n| ImageHeight = 4032\n| BitDepth = 8\n| ColorType = 2\n| Compression = 0\n| Filter = 0\n| Interlace = 0\nPNG caBX (215410 bytes):\nPNG pHYs (9 bytes):\n\n[BinaryData directory, 9 bytes]\n| PixelsPerUnitX = 3827\n| PixelsPerUnitY = 3827\n| PixelUnits = 1\n```\n\nこれは、PNGのチャンクを表している。\ncaBXというチャンクに215410 bytesの情報が格納されていることが分かるが、どのような情報が書き込まれているかが分からない。\n\nそこで、google検索で`\"caBX\" chunk`と検索すると[C2PA Technical Specification](https://c2pa.org/specifications/specifications/1.3/specs/_attachments/C2PA_Specification.pdf)という技術仕様がヒットする。これを軽く眺めると、画像の変更履歴を記録できる署名技術であることが分かる。\n問題の画像はおそらくこれを使っていることを推測できる。\n\nC2PAを扱うためのツールをgithubで検索すると\n\nhttps://github.com/contentauth/c2patool\n上記ツールがヒットする。これを手順に従ってインストールし、`c2patool signed_flag.png `\nを実行すると、caBXの情報が出力される。\n\ntimeを見て一番古い時刻が、2023-12-08T13:00:26+00:00であることがわかり\n署名した名前が、TSUKU4\\_IS\\_H@CKERであることがわかる。\n\nTsukuCTF23{TSUKU4\\_IS\\_H@CKER&2023-12-08T13:00:26+00:00}\n","title":"content_sign","description":"C2PAを使った画像の署名者と署名時刻を特定する","author":"7aru7aru","genre":"misc","solver":45,"point":481}},"__N_SSG":true}