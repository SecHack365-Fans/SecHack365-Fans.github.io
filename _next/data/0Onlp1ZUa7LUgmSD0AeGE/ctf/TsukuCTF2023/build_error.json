{"pageProps":{"postData":{"id":"build_error","contentHtml":"# build\\_error\n\n## 問題文\n\n怪盗シンボルより、以下の謎とき挑戦状が届いた。\n\n```text\n怪盗シンボルだ！\n\nメールに3つのファイルを添付した。\nこの3つのファイルを同じディレクトリに置き、makeとシェルに入力し実行するとビルドが走るようになっている。\n\nビルドを行い、標準出力からフラグを入手するのだ！\n\n追記：ソースコードは秘密\n```\n\n怪盗シンボルはせっかちなので、ビルドできるかチェックしているか不安だ。。。\n取り合えずチャレンジしてみよう。\n\nFlagフォーマットはTsukuCTF23{n桁の整数}になります。\n\n## 難易度\n\nMedium\n\n## 解法\n\n1. makeとシェルへ入力し、実行することで①のエラーが発生する。\\\n   ①GCCの場合\n\n```text\ncc main.o one.o -no-pie\n/usr/bin/ld: main.o: in function `main':\nmain.c:(.text+0xc): undefined reference to `a'\n/usr/bin/ld: main.c:(.text+0x13): undefined reference to `b'\ncollect2: エラー: ld はステータス 1 で終了しました\nmake: *** [Makefile:4: all] エラー 1\n```\n\n2. エラー内容を見るにmain.o内部でシンボルaとシンボルbが解決できていないことがわかる\n3. リンクするone.oのシンボル情報をnmコマンドで見てみると、②の出力が得られる。\\\n   ②\n\n```text\n0000000000000008 b a\n0000000000000010 b b\n0000000000000000 B c\n0000000000000000 T one_init\n\n```\n\n4. nmコマンドの出力におけるシンボルタイプは、小文字はローカル、大文字はグローバルとなっている。なので、aとbはローカルであり、cはグローバルであるとわかる。\n5. 1.と4.よりシンボルaとbが、グローバルなシンボルタイプであればよい。よって、③のコマンドを入力する。\\\n   ③\n\n```text\nobjcopy --globalize-symbol a one.o\nobjcopy --globalize-symbol b one.o\n```\n\n6. makeとシェルへ入力し、実行すると以下の出力が得られる。\n\n```text\nflag is 120\n```\n","title":"build_error","description":"シンボルタイプを調査して変更する問題","author":"Wagahaiha_toto","genre":"misc","solver":50,"point":476}},"__N_SSG":true}