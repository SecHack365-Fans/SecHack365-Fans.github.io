{"pageProps":{"postData":{"id":"new_cipher_scheme","contentHtml":"# new\\_cipher\\_scheme\n\n## 問題文\n\nI wouldn't worry about it being decrypted because of this complicated process!\n\n## 難易度\n\nmedium\n\n## 解法\n\nこの問題では普通のRSA暗号の数値に加え\n$$s = magic(p, q, r)$$\nの値が返されています。 $$magic2(a)$$\nの戻り値は\n$$\\sum\\_{i=0}^{a-1} (2i + 1) = a^2$$\nであることから $$s = (p + q)^8 mod r$$となります。\nよってこれの8乗根を求めてあげれば $$p+q$$が復元でき、あとは解と係数の関係によりdを求めることができます。\n8乗根はTonelli-Shanksのアルゴリズムを三回用いるか、もしくはsageを使ってやるといいでしょう\n\nTonelli-Shanks解\n\nhttps://qiita.com/motimotipurinn/items/d01e6d38a54e7207fafb\n\nこれを参考にしてください\n\nsage解\n\n```py\nfrom output import *\nfrom Crypto.Util.number import *\n\nPR.<x> = PolynomialRing(GF(r))\nf = x^8-s\nrs = f.roots()\nt = int(rs[-1][0])\nPR.<x> = PolynomialRing(ZZ)\nf = x^2-t*x+n\nrs = f.roots()\np = int(rs[0][0])\nq = int(rs[1][0])\nphi = (p - 1) * (q - 1)\nd = pow(e, -1, phi)\nprint(long_to_bytes(pow(int(c), int(d), int(n))))\n```\n","title":"new_cipher_scheme","description":"RSA暗号+8乗根","author":"motimoti_purinn","genre":"crypto","solver":31,"point":491}},"__N_SSG":true}