<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>GrandpaMemory-TsukuCTF2022</title><meta name="description" content="このサイトはSecHack365修了生よって運営されている非公式ののファンページです。"/><link rel="icon" href="/favicon.ico"/><meta name="og:title" content="GrandpaMemory-TsukuCTF2022"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:image" content="https://opengraph.githubassets.com/139256f8ccf77c03f7d9d1b51e30822cb3d14d45abeae53f15384cefc9c7e9da/SecHack365-Fans/SecHack365-Fans.github.io"/><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/d08ae8051f58b610.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d08ae8051f58b610.css" data-n-g=""/><link rel="preload" href="/_next/static/css/9559f1eba3ad545f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9559f1eba3ad545f.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-49b6f2937c9ce9f4.js" defer=""></script><script src="/_next/static/chunks/framework-dc33c0b5493501f0.js" defer=""></script><script src="/_next/static/chunks/main-056d531d8af152ad.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7e2d3fd7c9a12493.js" defer=""></script><script src="/_next/static/chunks/482-bd5197ea93394ef2.js" defer=""></script><script src="/_next/static/chunks/754-b8465c1d17288366.js" defer=""></script><script src="/_next/static/chunks/pages/ctf/TsukuCTF2022/%5Bid%5D-a940fa4d97f457fe.js" defer=""></script><script src="/_next/static/Y2SCC3ukKjnpNwdB23Spq/_buildManifest.js" defer=""></script><script src="/_next/static/Y2SCC3ukKjnpNwdB23Spq/_ssgManifest.js" defer=""></script><script src="/_next/static/Y2SCC3ukKjnpNwdB23Spq/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div><style data-emotion="css 1yjo05o">.css-1yjo05o{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-1yjo05o>:not(style)+:not(style){margin:0;margin-left:8px;}</style><div class="Navigator_navbar__1D91M css-1yjo05o"><span class="Navigator_left__6lj_E"><style data-emotion="css 11qrfta">.css-11qrfta{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;}.css-11qrfta:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-11qrfta:hover{background-color:transparent;}}.css-11qrfta.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css 1ujsas3">.css-1ujsas3{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;}.css-1ujsas3::-moz-focus-inner{border-style:none;}.css-1ujsas3.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1ujsas3{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1ujsas3:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-1ujsas3:hover{background-color:transparent;}}.css-1ujsas3.Mui-disabled{color:rgba(0, 0, 0, 0.26);}</style><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root Navigator_button__W2T1X Navigator_home__FJLJi css-1ujsas3" tabindex="0" href="/">TOP</a><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root Navigator_button__W2T1X Navigator_otherLink__EgnaA css-1ujsas3" tabindex="0" href="/blog">参加記</a><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root Navigator_button__W2T1X Navigator_otherLink__EgnaA css-1ujsas3" tabindex="0" href="/timer">†締切駆動コース†</a><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root Navigator_button__W2T1X Navigator_otherLink__EgnaA css-1ujsas3" tabindex="0" href="/ctf">TsukuCTF</a></span><span class="Navigator_right__OcvPs"><a class="MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButtonBase-root Navigator_button__W2T1X Navigator_otherLink__EgnaA Navigator_right__OcvPs css-1ujsas3" tabindex="0" href="https://github.com/SecHack365-Fans/SecHack365-Fans.github.io"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="GitHubIcon"><path d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"></path></svg></a></span></div><div style="padding:15px"><h1>GrandpaMemory</h1>
<p>今回の問題は、Research UNIX version1 上でコンパイルされた PDP-11/20 の実行ファイルを人力で逆アセンブルしてみるという問題となる。</p>
<h2>PDP エンディアン</h2>
<p>PDP-11 では特殊なエンディアンの方式が採用されていた。これは 32 ビットワードを構成する 2 つの 16 ビットワードはビッグエンディアンで格納され、16 ビットワードはリトルエンディアンで格納がされる。</p>
<p>詳しくは以下のリンク先を見てほしい。</p>
<p>https://ja.wikipedia.org/wiki/PDP-11</p>
<p>ただし、今回は 32 ビットのデータを扱っていないため、リトルエンディアンだけ抑えておけば問題ない。</p>
<h2>Research UNIX version1 のヘッダー</h2>
<p>重要なのは、ヘッダーが終わった 12 バイト目からプログラムが実行されるということである。
ヘッダーに関して詳しく知りたい場合、以下のリンク先を見てほしい。</p>
<p>https://www.bell-labs.com/usr/dmr/www/man51.pdf</p>
<h2>PDP-11 の命令</h2>
<p>エンディアンと同様に以下のリンク先が詳しい。</p>
<p><a href="https://ja.wikipedia.org/wiki/PDP-11#PDP%E3%82%A8%E3%83%B3%E3%83%87%E3%82%A3%E3%82%A2%E3%83%B3">PDP エンディアン</a></p>
<h2>解き方</h2>
<h3>PDP-11 のバイナリであることを知る</h3>
<p>実行ファイルに file コマンドを行ってみると以下の出力が見られる。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f08d49">file</span><span> a.out
</span>a.out: PDP-11 old overlay
</code></div></pre>
<p>ここから PDP-11 のバイナリであることがわかる。</p>
<h3>フラグがある場所を知る</h3>
<p>実行ファイルに cat コマンドを行ってみると以下のような出力が見られると思う。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#67cdcc">&gt;</span><span> </span><span class="token token" style="color:#f08d49">cat</span><span> a.out
</span><span></span><span class="token token" style="color:#f08d49">4</span><span>
</span>
<!-- -->�
<!-- -->�
<!-- -->�
<!-- --> �
<!-- -->  �
<!-- -->   �
<!-- -->    �
<span>     B`�passwd is </span><span class="token token" style="color:#cc99cd">in</span><span> R2</span></code></div></pre>
<p>passwd is in R2 という文字列から最終的な計算結果は R2 レジスタに入るとわかる。</p>
<h3>2 進数に変換して出力する</h3>
<p>xxd コマンドを利用し、2 進数でダンプを行う。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#67cdcc">&gt;</span><span>  xxd -g </span><span class="token token" style="color:#f08d49">1</span><span> -b a.out
</span><span>00000000: 00000101 00000001 00110100 00000000 00000000 00000000  </span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#f08d49">4</span><span class="token token" style="color:#ccc">..</span><span>.
</span><span>00000006: 00000000 00000000 00000000 00000000 00000000 00000000  </span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span>
</span><span>0000000c: 00000001 00001010 00000010 00001010 </span><span class="token token" style="color:#f08d49">10000001</span><span> 00001010  </span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span>
</span><span>00000012: </span><span class="token token" style="color:#f08d49">10000010</span><span> 00001010 </span><span class="token token" style="color:#f08d49">11000001</span><span> 00001100 </span><span class="token token" style="color:#f08d49">11000001</span><span> 00001100  </span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span>
</span><span>00000018: </span><span class="token token" style="color:#f08d49">11000001</span><span> 00001100 </span><span class="token token" style="color:#f08d49">11000001</span><span> 00001100 </span><span class="token token" style="color:#f08d49">11000010</span><span> 00001100  </span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span class="token token" style="color:#ccc">..</span><span>
</span><span>0000001e: 01000010 01100000 </span><span class="token token" style="color:#f08d49">11111111</span><span> 00000001 01110000 01100001  B`</span><span class="token token" style="color:#ccc">..</span><span>pa
</span>00000024: 01110011 01110011 01110111 01100100 00100000 01101001  sswd i
<span>0000002a: 01110011 00100000 01101001 01101110 00100000 01010010  s </span><span class="token token" style="color:#cc99cd">in</span><span> R
</span><span>00000030: 00110010 00100000 00000000 00001010                    </span><span class="token token" style="color:#f08d49">2</span><span> </span><span class="token token" style="color:#ccc">..</span></code></div></pre>
<p>このバイナリを読み解いていくのがこの問題となる。</p>
<h3>実行ファイルを読み解いていく</h3>
<p>まず、ヘッダーを取り除く。前述の通りヘッダは 12 バイトであり、プログラムはヘッダ直後から実行されていくためである。
ヘッダーを取り除くと以下の様になる。(アドレスと ascii コードも取り除いている)</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>00000001 00001010 00000010 00001010 10000001 00001010
</span>10000010 00001010 11000001 00001100 11000001 00001100
<!-- -->11000001 00001100 11000001 00001100 11000010 00001100
<!-- -->01000010 01100000 11111111 00000001
</code></div></pre>
<p>基本的に 16 ビットワードを１命令として扱うため、16 ビットずつ見ていこう。</p>
<h4>00000001_00001010</h4>
<p>以下二進数はリトルエンディアンとして 1 バイト逆に置き換えたものである。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>0000101000 000001</span></code></div></pre>
<p>上位 4 ビットに値がないことから 2 オペンランド命令でないことがわかる。
また、11 ビット目が 0 でないことから無条件分岐命令でないこともわかる。</p>
<p>要するにこれは、1 オペランド命令となる。1 オペランド命令は上位 10 ビットが命令コードとなるので 0000101000 が命令となる。参考リンク先では、8 進数で命令コードが表現されているので 0000101000 を 8 進数に置き換えると 50 である。50 は CLR 命令であるので、レジスタを 0 クリアしていることがわかる。レジスタは 2~0 ビットで指定するので R1 を 0 クリアしていることがわかる。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>CLR R1</span></code></div></pre>
<h4>00000010_00001010</h4>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>0000101000 000010</span></code></div></pre>
<p>前の命令と同じ命令コードなので CLR 命令であることがわかる。また、レジスタは 10 であるので R2 を示していることがわかる。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>CLR R2</span></code></div></pre>
<h4>10000001 00001010</h4>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>0000101010 000001</span></code></div></pre>
<p>CLR 命令と同様に１オペランド命令である。0000101010 は 8 進数で表すと 52 であり、INC 命令であることがわかる。またレジスタは R1 を示していることがわかる。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>INC R1</span></code></div></pre>
<h4>10000010_00001010</h4>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>0000101010 000010</span></code></div></pre>
<p>前の命令と同じく INC 命令である。レジスタは 10 であるため R2 である。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>INC R2</span></code></div></pre>
<h4>11000001_00001100</h4>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>0000110011 000001</span></code></div></pre>
<p>この命令も 1 オペランド命令である。11011 を 8 進数にすると 63 であり、ASR 命令であるとわかる。またレジスタは R1 である。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>ASR R1</span></code></div></pre>
<p>また、この命令が 4 命令続く。</p>
<h4>11000010_00001100</h4>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>0000110011 000010</span></code></div></pre>
<p>この命令は前の命令と同じく ASR 命令であり、レジスタが 10 であることから R2 となる。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>ASR R2</span></code></div></pre>
<h4>01000010_01100000</h4>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>0110 000001 000010</span></code></div></pre>
<p>この命令の場合、11 ビット目が 0 であり、最上位ビットから 4 ビットにデータがあることから 2 オペランド命令であることがわかる。2 オペランド命令は最上位ビットから 4 ビットが命令コードを表すので、0110 が命令コードとなる。0110 を 8 進数に変換すると、6 となる。よって ADD 命令であることがわかる。また、レジスタは 8/~6 ビット目と 2/~0 ビット目が source と destination を示すので、source が R1 であり、destination が R2 であることがわかる。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>ADD R1, R2</span></code></div></pre>
<h4>11111111_00000001</h4>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>00000001 11111111</span></code></div></pre>
<p>この命令の場合、11 ビット目が 0 かつ上位 7 ビットに命令コードがないため条件分岐命令であることがわかる。その場合、参考先のように命令を解釈すると、0000000100000000 となり 4XX であるとわかる。また、11111111 は無条件分岐のオフセットは符号付整数であるため、2 の補数表現からマイナスであることがわかる。よって無限ループとなっている。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-txt" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>BR -1(実際はラベル)</span></code></div></pre>
<h4>結果</h4>
<p>今回元となった機械語のプログラムは以下になる。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__r6Sqc" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-asm" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>/ tukuCTF GrandpaMemory
</span>   clr r1
<!-- -->   clr r2
<!-- -->   inc r1
<!-- -->   inc r2
<!-- -->   asl r1
<!-- -->   asl r1
<!-- -->   asl r1
<!-- -->   asl r1
<!-- -->   asl r2
<!-- -->   add r1, r2
<!-- -->1:
<!-- -->   br 1b
<!-- -->
<!-- -->
<!-- -->hint:
<!-- -->    &lt;passwd is in R2 \0\n&gt;
</code></div></pre>
<p>まず、r1 と r2 レジスタを 0 クリアする。その後、r1,r2 をインクリメントし r1=1,r2=1 とする。また、asl は左シフトで値を 2 倍にする命令である。よって、計算結果は R2=18 となる。</p>
<h2>フラグ</h2>
<p>TsukuCTF22{18}</p></div><div class="Footer_footer__WOAaR">© 2021-<!-- -->2022<!-- --> SecHack365-Fans All Right Reserved.</div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"GrandpaMemory","contentHtml":"# GrandpaMemory\n\n今回の問題は、Research UNIX version1 上でコンパイルされた PDP-11/20 の実行ファイルを人力で逆アセンブルしてみるという問題となる。\n\n## PDP エンディアン\n\nPDP-11 では特殊なエンディアンの方式が採用されていた。これは 32 ビットワードを構成する 2 つの 16 ビットワードはビッグエンディアンで格納され、16 ビットワードはリトルエンディアンで格納がされる。\n\n詳しくは以下のリンク先を見てほしい。\n\nhttps://ja.wikipedia.org/wiki/PDP-11\n\nただし、今回は 32 ビットのデータを扱っていないため、リトルエンディアンだけ抑えておけば問題ない。\n\n## Research UNIX version1 のヘッダー\n\n重要なのは、ヘッダーが終わった 12 バイト目からプログラムが実行されるということである。\nヘッダーに関して詳しく知りたい場合、以下のリンク先を見てほしい。\n\nhttps://www.bell-labs.com/usr/dmr/www/man51.pdf\n\n## PDP-11 の命令\n\nエンディアンと同様に以下のリンク先が詳しい。\n\n[PDP エンディアン](https://ja.wikipedia.org/wiki/PDP-11#PDP%E3%82%A8%E3%83%B3%E3%83%87%E3%82%A3%E3%82%A2%E3%83%B3)\n\n## 解き方\n\n### PDP-11 のバイナリであることを知る\n\n実行ファイルに file コマンドを行ってみると以下の出力が見られる。\n\n```bash\n\u003e file a.out\na.out: PDP-11 old overlay\n```\n\nここから PDP-11 のバイナリであることがわかる。\n\n### フラグがある場所を知る\n\n実行ファイルに cat コマンドを行ってみると以下のような出力が見られると思う。\n\n```bash\n\u003e cat a.out\n4\n\n�\n�\n�\n �\n  �\n   �\n    �\n     B`�passwd is in R2\n```\n\npasswd is in R2 という文字列から最終的な計算結果は R2 レジスタに入るとわかる。\n\n### 2 進数に変換して出力する\n\nxxd コマンドを利用し、2 進数でダンプを行う。\n\n```bash\n\u003e  xxd -g 1 -b a.out\n00000000: 00000101 00000001 00110100 00000000 00000000 00000000  ..4...\n00000006: 00000000 00000000 00000000 00000000 00000000 00000000  ......\n0000000c: 00000001 00001010 00000010 00001010 10000001 00001010  ......\n00000012: 10000010 00001010 11000001 00001100 11000001 00001100  ......\n00000018: 11000001 00001100 11000001 00001100 11000010 00001100  ......\n0000001e: 01000010 01100000 11111111 00000001 01110000 01100001  B`..pa\n00000024: 01110011 01110011 01110111 01100100 00100000 01101001  sswd i\n0000002a: 01110011 00100000 01101001 01101110 00100000 01010010  s in R\n00000030: 00110010 00100000 00000000 00001010                    2 ..\n```\n\nこのバイナリを読み解いていくのがこの問題となる。\n\n### 実行ファイルを読み解いていく\n\nまず、ヘッダーを取り除く。前述の通りヘッダは 12 バイトであり、プログラムはヘッダ直後から実行されていくためである。\nヘッダーを取り除くと以下の様になる。(アドレスと ascii コードも取り除いている)\n\n```txt\n00000001 00001010 00000010 00001010 10000001 00001010\n10000010 00001010 11000001 00001100 11000001 00001100\n11000001 00001100 11000001 00001100 11000010 00001100\n01000010 01100000 11111111 00000001\n```\n\n基本的に 16 ビットワードを１命令として扱うため、16 ビットずつ見ていこう。\n\n#### 00000001\\_00001010\n\n以下二進数はリトルエンディアンとして 1 バイト逆に置き換えたものである。\n\n```txt\n0000101000 000001\n```\n\n上位 4 ビットに値がないことから 2 オペンランド命令でないことがわかる。\nまた、11 ビット目が 0 でないことから無条件分岐命令でないこともわかる。\n\n要するにこれは、1 オペランド命令となる。1 オペランド命令は上位 10 ビットが命令コードとなるので 0000101000 が命令となる。参考リンク先では、8 進数で命令コードが表現されているので 0000101000 を 8 進数に置き換えると 50 である。50 は CLR 命令であるので、レジスタを 0 クリアしていることがわかる。レジスタは 2~0 ビットで指定するので R1 を 0 クリアしていることがわかる。\n\n```txt\nCLR R1\n```\n\n#### 00000010\\_00001010\n\n```txt\n0000101000 000010\n```\n\n前の命令と同じ命令コードなので CLR 命令であることがわかる。また、レジスタは 10 であるので R2 を示していることがわかる。\n\n```txt\nCLR R2\n```\n\n#### 10000001 00001010\n\n```txt\n0000101010 000001\n```\n\nCLR 命令と同様に１オペランド命令である。0000101010 は 8 進数で表すと 52 であり、INC 命令であることがわかる。またレジスタは R1 を示していることがわかる。\n\n```txt\nINC R1\n```\n\n#### 10000010\\_00001010\n\n```txt\n0000101010 000010\n```\n\n前の命令と同じく INC 命令である。レジスタは 10 であるため R2 である。\n\n```txt\nINC R2\n```\n\n#### 11000001\\_00001100\n\n```txt\n0000110011 000001\n```\n\nこの命令も 1 オペランド命令である。11011 を 8 進数にすると 63 であり、ASR 命令であるとわかる。またレジスタは R1 である。\n\n```txt\nASR R1\n```\n\nまた、この命令が 4 命令続く。\n\n#### 11000010\\_00001100\n\n```txt\n0000110011 000010\n```\n\nこの命令は前の命令と同じく ASR 命令であり、レジスタが 10 であることから R2 となる。\n\n```txt\nASR R2\n```\n\n#### 01000010\\_01100000\n\n```txt\n0110 000001 000010\n```\n\nこの命令の場合、11 ビット目が 0 であり、最上位ビットから 4 ビットにデータがあることから 2 オペランド命令であることがわかる。2 オペランド命令は最上位ビットから 4 ビットが命令コードを表すので、0110 が命令コードとなる。0110 を 8 進数に変換すると、6 となる。よって ADD 命令であることがわかる。また、レジスタは 8/~6 ビット目と 2/~0 ビット目が source と destination を示すので、source が R1 であり、destination が R2 であることがわかる。\n\n```txt\nADD R1, R2\n```\n\n#### 11111111\\_00000001\n\n```txt\n00000001 11111111\n```\n\nこの命令の場合、11 ビット目が 0 かつ上位 7 ビットに命令コードがないため条件分岐命令であることがわかる。その場合、参考先のように命令を解釈すると、0000000100000000 となり 4XX であるとわかる。また、11111111 は無条件分岐のオフセットは符号付整数であるため、2 の補数表現からマイナスであることがわかる。よって無限ループとなっている。\n\n```txt\nBR -1(実際はラベル)\n```\n\n#### 結果\n\n今回元となった機械語のプログラムは以下になる。\n\n```asm\n/ tukuCTF GrandpaMemory\n   clr r1\n   clr r2\n   inc r1\n   inc r2\n   asl r1\n   asl r1\n   asl r1\n   asl r1\n   asl r2\n   add r1, r2\n1:\n   br 1b\n\n\nhint:\n    \u003cpasswd is in R2 \\0\\n\u003e\n```\n\nまず、r1 と r2 レジスタを 0 クリアする。その後、r1,r2 をインクリメントし r1=1,r2=1 とする。また、asl は左シフトで値を 2 倍にする命令である。よって、計算結果は R2=18 となる。\n\n## フラグ\n\nTsukuCTF22{18}\n","title":"GrandpaMemory","description":"実行ファイルを読んでみる。","author":"Wagahaiha_toto","genre":"Rev","solver":17,"point":498}},"__N_SSG":true},"page":"/ctf/TsukuCTF2022/[id]","query":{"id":"GrandpaMemory"},"buildId":"Y2SCC3ukKjnpNwdB23Spq","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>