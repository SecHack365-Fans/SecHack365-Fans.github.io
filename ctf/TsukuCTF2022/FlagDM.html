<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>FlagDM-TsukuCTF2022</title><meta name="description" content="このサイトはSecHack365修了生よって運営されている非公式ののファンページです。"/><link rel="icon" href="/favicon.ico"/><meta name="og:title" content="FlagDM-TsukuCTF2022"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:image" content="https://fans.sechack365.com/images/tsukuctf-logo.png"/><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/21f8e083f97816c3.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/21f8e083f97816c3.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/ffca696ef8ef2fa4.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/ffca696ef8ef2fa4.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-146cc4e76e722037.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-10fac88913917d91.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-3ae351249979994e.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-7ede516a3bfbb4df.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/1bfc9850-950c562bd9f4b960.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/147-d128eadc2dac4c62.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/212-7f8e90692937549a.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/ctf/TsukuCTF2022/%5Bid%5D-075992e9a33d74f0.js" defer="" crossorigin=""></script><script src="/_next/static/pGek_3YC8jk9kHJKsQkjz/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/pGek_3YC8jk9kHJKsQkjz/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div><div class="x1aogm5o xvqvw8y xudrmeu x78zum5 x1q0g3np x6s0dn4"><a class="xrv4cvt xc342km x1sxf85j x5yr21d x1ypdohk x78zum5 x6s0dn4 xexx8yu x1iji9kk x18d9i69 x1sln4lm x1aogm5o x18eybuq xxzecl9 x117nqv4 xd8780z xnc0nkd x17ituo4 x1sivnnp" href="/">TOP</a><a class="xrv4cvt xc342km x1sxf85j x5yr21d x1ypdohk x78zum5 x6s0dn4 xexx8yu x1iji9kk x18d9i69 x1sln4lm x1aogm5o x18eybuq x19xzur5 xd8780z xnc0nkd x17ituo4 x1sivnnp" href="/blog">参加記</a><a class="xrv4cvt xc342km x1sxf85j x5yr21d x1ypdohk x78zum5 x6s0dn4 xexx8yu x1iji9kk x18d9i69 x1sln4lm x1aogm5o x18eybuq x19xzur5 xd8780z xnc0nkd x17ituo4 x1sivnnp" href="/timer">†締切駆動コース†</a><a class="xrv4cvt xc342km x1sxf85j x5yr21d x1ypdohk x78zum5 x6s0dn4 xexx8yu x1iji9kk x18d9i69 x1sln4lm x1aogm5o x18eybuq x19xzur5 xd8780z xnc0nkd x17ituo4 x1sivnnp" href="/ctf">TsukuCTF</a><a class="xrv4cvt xc342km x1sxf85j x5yr21d x1ypdohk x78zum5 x6s0dn4 xexx8yu x1iji9kk x18d9i69 x1sln4lm x1aogm5o x18eybuq x19xzur5 xd8780z xnc0nkd x17ituo4 x1sivnnp" href="https://github.com/SecHack365-Fans/SecHack365-Fans.github.io"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div><div style="padding:15px"><h1>FlagDM</h1>
<h2>Phase 1 (Get Email)</h2>
<p>Google ドキュメントの URL が与えられます。Google ドキュメントには作成者に関するさまざまな情報が含まれています。その情報を知る手段として<a href="https://github.com/mxrch/GHunt">GHunt</a>があります。しかし、GHunt は doc コマンドは<a href="https://github.com/mxrch/GHunt/issues/360">issue にも書かれている通り</a>、一時的に使用できませんでした(勿論、現時点では使用できる可能性もあります)。</p>
<p>そこで、ここでは<a href="https://github.com/Malfrats/xeuledoc">xeuledoc</a>を使用します。これは GHunt と殆ど同じコードですが、<a href="https://github.com/Malfrats/xeuledoc/blob/master/xeuledoc/core.py#L37">Google Internal token</a>の関係で GHunt を使用できない場合でも、こちらは使用できることがあります。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ xeuledoc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span>Twitter </span><span class="token token" style="color:#f8c555">:</span><span> @MalfratsInd
</span><span>Github </span><span class="token token" style="color:#f8c555">:</span><span> https://github.com/Malfrats/xeuledoc
</span>
<span>Document ID </span><span class="token token" style="color:#f8c555">:</span><span> 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Creation </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:18:33 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Last edit </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:29:36 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>Public permissions </span><span class="token token" style="color:#f8c555">:</span><span>
</span>- reader
<!-- -->
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Owner found </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<span>Name </span><span class="token token" style="color:#f8c555">:</span><span> my real name is secret
</span><span>Email </span><span class="token token" style="color:#f8c555">:</span><span> mpju40nchoyba85@gmail.com
</span><span>Google ID </span><span class="token token" style="color:#f8c555">:</span><span> 03458870179467391774</span></code></div></pre>
<p>このように名前、Email、Google ID などが手に入りました。名前は偽名のようです。しかし、Email が手に入ったのでこれを使用します。</p>
<h2>Phase 2 (Get Twitter)</h2>
<p>先ほどの GHunt を用いて、Email から Gaia ID を取得します。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 ghunt.py email mpju40nchoyba85@gmail.com
</span>
<span>     .d8888b.  </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    d88P  Y88b </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>        </span><span class="token token" style="color:#f08d49">8888888888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> 88888b.  </span><span class="token token" style="color:#f08d49">888888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">88888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#7ec699">&quot;88b 888
</span><span class="token token" style="color:#7ec699">    888    888 888    888 888  888 888  888 888
</span><span class="token token" style="color:#7ec699">    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.
</span><span class="token token" style="color:#7ec699">     &quot;</span><span>Y8888P88 </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#7ec699">&quot;Y88888 888  888  &quot;</span><span>Y888
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#f08d49">1</span><span> account found </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<!-- -->------------------------------
<!-- -->
<span>Name </span><span class="token token" style="color:#f8c555">:</span><span> my real name is secret
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Custom profile picture </span><span class="token token" style="color:#67cdcc">!</span><span>
</span><span></span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#67cdcc">&gt;</span><span> https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS
</span><span>Profile picture saved </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<span>Last profile edit </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/04 </span><span class="token token" style="color:#f08d49">17</span><span>:21:29 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>Email </span><span class="token token" style="color:#f8c555">:</span><span> mpju40nchoyba85@gmail.com
</span><span>Gaia ID </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">117114600888142762916</span><span>
</span>
<span>Hangouts Bot </span><span class="token token" style="color:#f8c555">:</span><span> No
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> Unable to fetch connected Google services.
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> YouTube channel not found.
</span>
<span>Google Maps </span><span class="token token" style="color:#f8c555">:</span><span> https://www.google.com/maps/contrib/117114600888142762916/reviews
</span><span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> No reviews
</span>
<span>Google Calendar </span><span class="token token" style="color:#f8c555">:</span><span> https://calendar.google.com/calendar/u/0/embed?src</span><span class="token token" style="color:#67cdcc">=</span><span>mpju40nchoyba85@gmail.com
</span><span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> No public Google Calendar.</span></code></div></pre>
<p><code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">Gaia ID : 117114600888142762916</code>と表記されています。また、この箇所に注目してください。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Google Maps </span><span class="token token" style="color:#f8c555">:</span><span> https://www.google.com/maps/contrib/117114600888142762916/reviews
</span><span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> No reviews</span></code></div></pre>
<p>この人は Google Map のレビューを投稿していないように見えます。しかし、実際には存在します。<a href="https://www.google.com/maps/contrib/117114600888142762916/reviews">こちら</a>の「写真」をクリックしてみてください。表示しない設定においても、レビューの写真のみ表示されています。</p>
<p><img src="https://raw.githubusercontent.com/SecHack365-Fans/SecHack365-Fans.github.io/master/pages/ctf/TsukuCTF2022/writeups/FlagDM/review.png" alt="review" style="width:80%"/></p>
<p>よく見ると権利表記の Twitter ID が表示されています。<code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">@07xm8d9pzp</code></p>
<p><a href="https://twitter.com/07xm8d9pzp">https://twitter.com/07xm8d9pzp</a></p>
<p>プロフィールに Youtube のチャンネルが記載されています。</p>
<p><a href="https://www.youtube.com/channel/UCZ7_GtoaC4oHCKBLhJi13Ww">https://www.youtube.com/channel/UCZ7_GtoaC4oHCKBLhJi13Ww</a></p>
<p><code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">gross_poem</code>というユーザ名を使用していることがわかりました。</p>
<h2>Phase 3 (Get Flag)</h2>
<p>このユーザ名を用いて、使用している別のサービスを探します。これは、<a href="https://github.com/sherlock-project/sherlock">sherlock</a>が非常に便利です。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ python3 sherlock gross_poem
</span><span>Update Available</span><span class="token token" style="color:#67cdcc">!</span><span>
</span><span>You are running version </span><span class="token token" style="color:#f08d49">0.14</span><span>.0. Version </span><span class="token token" style="color:#f08d49">0.14</span><span>.2 is available at https://git.io/sherlock
</span><span></span><span class="token token" style="color:#ccc">[</span><span>*</span><span class="token token" style="color:#ccc">]</span><span> Checking username gross_poem on:
</span>
<!-- -->
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Trakt: https://www.trakt.tv/users/gross_poem
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> koo: https://www.kooapp.com/profile/gross_poem
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> skyrock: https://gross_poem.skyrock.com/</span></code></div></pre>
<p>このうち、<a href="https://www.trakt.tv/users/gross_poem">Trakt</a>を開くと明らかに怪しい Base64 の文字列が表示されています。</p>
<p><code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==</code></p>
<p>Base64 をデコードします。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ </span><span class="token token" style="color:#f8c555">echo</span><span> </span><span class="token token" style="color:#7ec699">&quot;TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==&quot;</span><span> </span><span class="token token" style="color:#67cdcc">|</span><span> base64 -d
</span><span>Nice</span><span class="token token" style="color:#67cdcc">!</span><span> Flag is Here</span><span class="token token" style="color:#67cdcc">!</span><span> -</span><span class="token token" style="color:#67cdcc">&gt;</span><span> TsukuCTF22</span><span class="token token" style="color:#ccc">{</span><span>M4ny_0S1N7_700ls_3x157</span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<h2>Flag</h2>
<p><code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">TsukuCTF22{M4ny_0S1N7_700ls_3x157}</code></p>
<h2>Tips</h2>
<p>実は GHunt でも<code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">resources/data.txt</code>の<code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">internal</code>に xeuledoc のトークンを使用すると、正常に動作します。</p>
<p>結果的に変更される箇所はここです。</p>
<p><a href="https://github.com/mxrch/GHunt/blob/4601d75d6bb12c33a605a7ac5bf88e151e9ba3d3/modules/email.py#L46">https://github.com/mxrch/GHunt/blob/4601d75d6bb12c33a605a7ac5bf88e151e9ba3d3/modules/email.py#L46</a></p>
<p>最終的な出力は以下のようになります。</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ python3 ghunt.py doc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span>     .d8888b.  </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    d88P  Y88b </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>        </span><span class="token token" style="color:#f08d49">8888888888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> 88888b.  </span><span class="token token" style="color:#f08d49">888888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">88888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#7ec699">&quot;88b 888
</span><span class="token token" style="color:#7ec699">    888    888 888    888 888  888 888  888 888
</span><span class="token token" style="color:#7ec699">    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.
</span><span class="token token" style="color:#7ec699">     &quot;</span><span>Y8888P88 </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#7ec699">&quot;Y88888 888  888  &quot;</span><span>Y888
</span>
<!-- -->
<span>Document ID </span><span class="token token" style="color:#f8c555">:</span><span> 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span></span><span class="token token" style="color:#ccc">{</span><span>
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;kind&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;drive#file&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;userPermission&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;me&quot;</span><span>,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;type&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;user&quot;</span><span>,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;role&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;reader&quot;</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">}</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;parents&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;iconLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;https://drive-thirdparty.googleusercontent.com/16/type/application/vnd.google-apps.document&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;shared&quot;</span><span class="token token" style="color:#f8c555">:</span><span> true,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;alternateLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg/edit?usp=drivesdk&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;fileSize&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;31860&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;copyRequiresWriterPermission&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;permissions&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">[</span><span>
</span><span>    </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;anyoneWithLink&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;type&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;anyone&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;role&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;reader&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;withLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">true</span><span>
</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>,
</span><span>    </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;03458870179467391774&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;name&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;my real name is secret (gross_poem)&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;type&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;user&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;role&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;owner&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;photoLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS=s64&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;emailAddress&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;mpju40nchoyba85@gmail.com&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;domain&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;gmail.com&quot;</span><span>
</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">]</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;labels&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;starred&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;trashed&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">false</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">}</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;createdDate&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;2022-10-03T12:18:33.160Z&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;modifiedDate&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;2022-10-03T12:29:36.221Z&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;capabilities&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canEdit&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canComment&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canAddChildren&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canDownload&quot;</span><span class="token token" style="color:#f8c555">:</span><span> true,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canRemoveChildren&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canRename&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveItemIntoTeamDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveItemOutOfDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveItemWithinDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveChildrenWithinDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">false</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">}</span><span>
</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Creation </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:18:33 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Last edit </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:29:36 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>Public permissions </span><span class="token token" style="color:#f8c555">:</span><span>
</span>- reader
<!-- -->
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Owner found </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<span>Name </span><span class="token token" style="color:#f8c555">:</span><span> my real name is secret
</span><span>Email </span><span class="token token" style="color:#f8c555">:</span><span> mpju40nchoyba85@gmail.com
</span><span>Google ID </span><span class="token token" style="color:#f8c555">:</span><span> 03458870179467391774
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Custom profile picture </span><span class="token token" style="color:#67cdcc">!</span><span>
</span><span></span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#67cdcc">&gt;</span><span> https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS</span><span class="token token" style="color:#67cdcc">=</span><span>s64
</span><span>Profile picture saved </span><span class="token token" style="color:#67cdcc">!</span></code></div></pre>
<p>しかし、このトークンでは doc コマンドしか使用する権限がありません。</p>
<h2>Phase 1 (Get Email)</h2>
<p>Google Document URL is provided. Google docs contains many infos related to author. <a href="https://github.com/mxrch/GHunt">GHunt</a> is a great tool to know those infos. However, GHunt doc command seems not available today according to an <a href="https://github.com/mxrch/GHunt/issues/360">issue</a> (Of course, you may be able to use it now)
So in this write-up, we&#x27;ll use <a href="https://github.com/Malfrats/xeuledoc">xeuledoc</a>. Even though this is similar to GHunt, we may be able to use this even though we can&#x27;t run GHunt because of <a href="https://github.com/Malfrats/xeuledoc/blob/master/xeuledoc/core.py#L37">Google Internal token</a></p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ xeuledoc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span>Twitter </span><span class="token token" style="color:#f8c555">:</span><span> @MalfratsInd
</span><span>Github </span><span class="token token" style="color:#f8c555">:</span><span> https://github.com/Malfrats/xeuledoc
</span>
<span>Document ID </span><span class="token token" style="color:#f8c555">:</span><span> 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Creation </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:18:33 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Last edit </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:29:36 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>Public permissions </span><span class="token token" style="color:#f8c555">:</span><span>
</span>- reader
<!-- -->
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Owner found </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<span>Name </span><span class="token token" style="color:#f8c555">:</span><span> my real name is secret
</span><span>Email </span><span class="token token" style="color:#f8c555">:</span><span> mpju40nchoyba85@gmail.com
</span><span>Google ID </span><span class="token token" style="color:#f8c555">:</span><span> 03458870179467391774</span></code></div></pre>
<p>We can get Name, Email, and Google ID. The name seems useless. However, we get an e-mail.</p>
<h2>Phase 2 (Get Twitter)</h2>
<p>With using GHunt, we can detect Gaia ID from Email.</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 ghunt.py email mpju40nchoyba85@gmail.com
</span>
<span>     .d8888b.  </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    d88P  Y88b </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>        </span><span class="token token" style="color:#f08d49">8888888888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> 88888b.  </span><span class="token token" style="color:#f08d49">888888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">88888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#7ec699">&quot;88b 888
</span><span class="token token" style="color:#7ec699">    888    888 888    888 888  888 888  888 888
</span><span class="token token" style="color:#7ec699">    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.
</span><span class="token token" style="color:#7ec699">     &quot;</span><span>Y8888P88 </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#7ec699">&quot;Y88888 888  888  &quot;</span><span>Y888
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> </span><span class="token token" style="color:#f08d49">1</span><span> account found </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<!-- -->------------------------------
<!-- -->
<span>Name </span><span class="token token" style="color:#f8c555">:</span><span> my real name is secret
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Custom profile picture </span><span class="token token" style="color:#67cdcc">!</span><span>
</span><span></span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#67cdcc">&gt;</span><span> https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS
</span><span>Profile picture saved </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<span>Last profile edit </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/04 </span><span class="token token" style="color:#f08d49">17</span><span>:21:29 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>Email </span><span class="token token" style="color:#f8c555">:</span><span> mpju40nchoyba85@gmail.com
</span><span>Gaia ID </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">117114600888142762916</span><span>
</span>
<span>Hangouts Bot </span><span class="token token" style="color:#f8c555">:</span><span> No
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> Unable to fetch connected Google services.
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> YouTube channel not found.
</span>
<span>Google Maps </span><span class="token token" style="color:#f8c555">:</span><span> https://www.google.com/maps/contrib/117114600888142762916/reviews
</span><span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> No reviews
</span>
<span>Google Calendar </span><span class="token token" style="color:#f8c555">:</span><span> https://calendar.google.com/calendar/u/0/embed?src</span><span class="token token" style="color:#67cdcc">=</span><span>mpju40nchoyba85@gmail.com
</span><span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> No public Google Calendar.</span></code></div></pre>
<p>GHunt says <code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">Gaia ID : 117114600888142762916</code>.
And this person doesn&#x27;t seem to provide any Google Map reviews as GHunt says</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Google Maps </span><span class="token token" style="color:#f8c555">:</span><span> https://www.google.com/maps/contrib/117114600888142762916/reviews
</span><span></span><span class="token token" style="color:#ccc">[</span><span>-</span><span class="token token" style="color:#ccc">]</span><span> No reviews</span></code></div></pre>
<p>However, (s)he does! Let&#x27;s click the photo(写真) tab in <a href="https://www.google.com/maps/contrib/117114600888142762916/reviews">this page</a>. Even though the review is set not to display, the photo is displayed.</p>
<p><img src="https://raw.githubusercontent.com/SecHack365-Fans/SecHack365-Fans.github.io/master/pages/ctf/TsukuCTF2022/writeups/FlagDM/review.png" alt="review" style="width:80%"/></p>
<p>You can find Twitter ID <code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">@07xm8d9pzp</code> in the photo.
<a href="https://twitter.com/07xm8d9pzp">https://twitter.com/07xm8d9pzp</a></p>
<p>And you&#x27;ll find YouTube link in Twitter profile.
<a href="https://www.youtube.com/channel/UCZ7_GtoaC4oHCKBLhJi13Ww">https://www.youtube.com/channel/UCZ7_GtoaC4oHCKBLhJi13Ww</a></p>
<p>Now this person use <code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">gross_poem</code> as his account name.</p>
<h2>Phase 3 (Get Flag)</h2>
<p>Detect other services based on this user name. <a href="https://github.com/sherlock-project/sherlock">sherlock</a> is a great tool to do this.</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ python3 sherlock gross_poem
</span><span>Update Available</span><span class="token token" style="color:#67cdcc">!</span><span>
</span><span>You are running version </span><span class="token token" style="color:#f08d49">0.14</span><span>.0. Version </span><span class="token token" style="color:#f08d49">0.14</span><span>.2 is available at https://git.io/sherlock
</span><span></span><span class="token token" style="color:#ccc">[</span><span>*</span><span class="token token" style="color:#ccc">]</span><span> Checking username gross_poem on:
</span>
<!-- -->
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Trakt: https://www.trakt.tv/users/gross_poem
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> koo: https://www.kooapp.com/profile/gross_poem
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> skyrock: https://gross_poem.skyrock.com/</span></code></div></pre>
<p>You&#x27;ll find a very strange Base64 string in <a href="https://www.trakt.tv/users/gross_poem">Trakt</a></p>
<p><code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==</code></p>
<p>Decode this string and you&#x27;ll get the FLAG.</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ </span><span class="token token" style="color:#f8c555">echo</span><span> </span><span class="token token" style="color:#7ec699">&quot;TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==&quot;</span><span> </span><span class="token token" style="color:#67cdcc">|</span><span> base64 -d
</span><span>Nice</span><span class="token token" style="color:#67cdcc">!</span><span> Flag is Here</span><span class="token token" style="color:#67cdcc">!</span><span> -</span><span class="token token" style="color:#67cdcc">&gt;</span><span> TsukuCTF22</span><span class="token token" style="color:#ccc">{</span><span>M4ny_0S1N7_700ls_3x157</span><span class="token token" style="color:#ccc">}</span></code></div></pre>
<h2>Flag</h2>
<p><code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">TsukuCTF22{M4ny_0S1N7_700ls_3x157}</code></p>
<h2>Tips</h2>
<p>Actually, GHunt works fine when you specify xeuledoc token at <code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">internal</code> in <code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">resources/data.txt</code>.</p>
<p>This will be modified
<a href="https://github.com/mxrch/GHunt/blob/4601d75d6bb12c33a605a7ac5bf88e151e9ba3d3/modules/email.py#L46">https://github.com/mxrch/GHunt/blob/4601d75d6bb12c33a605a7ac5bf88e151e9ba3d3/modules/email.py#L46</a></p>
<p>And the result is following</p>
<pre><div node="[object Object]" class="MarkdownRender_code__F4sq8" style="color:#ccc;background:#2d2d2d;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:#ccc;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ python3 ghunt.py doc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span>     .d8888b.  </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    d88P  Y88b </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>                   </span><span class="token token" style="color:#f08d49">888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>        </span><span class="token token" style="color:#f08d49">8888888888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> 88888b.  </span><span class="token token" style="color:#f08d49">888888</span><span>
</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">88888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#f08d49">888</span><span> </span><span class="token token" style="color:#7ec699">&quot;88b 888
</span><span class="token token" style="color:#7ec699">    888    888 888    888 888  888 888  888 888
</span><span class="token token" style="color:#7ec699">    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.
</span><span class="token token" style="color:#7ec699">     &quot;</span><span>Y8888P88 </span><span class="token token" style="color:#f08d49">888</span><span>    </span><span class="token token" style="color:#f08d49">888</span><span>  </span><span class="token token" style="color:#7ec699">&quot;Y88888 888  888  &quot;</span><span>Y888
</span>
<!-- -->
<span>Document ID </span><span class="token token" style="color:#f8c555">:</span><span> 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg
</span>
<span></span><span class="token token" style="color:#ccc">{</span><span>
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;kind&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;drive#file&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;userPermission&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;me&quot;</span><span>,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;type&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;user&quot;</span><span>,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;role&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;reader&quot;</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">}</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;parents&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;iconLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;https://drive-thirdparty.googleusercontent.com/16/type/application/vnd.google-apps.document&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;shared&quot;</span><span class="token token" style="color:#f8c555">:</span><span> true,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;alternateLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg/edit?usp=drivesdk&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;fileSize&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;31860&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;copyRequiresWriterPermission&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;permissions&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">[</span><span>
</span><span>    </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;anyoneWithLink&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;type&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;anyone&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;role&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;reader&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;withLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">true</span><span>
</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>,
</span><span>    </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;03458870179467391774&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;name&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;my real name is secret (gross_poem)&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;type&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;user&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;role&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;owner&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;photoLink&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS=s64&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;emailAddress&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;mpju40nchoyba85@gmail.com&quot;</span><span>,
</span><span>      </span><span class="token token" style="color:#7ec699">&quot;domain&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;gmail.com&quot;</span><span>
</span><span>    </span><span class="token token" style="color:#ccc">}</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">]</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;id&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;labels&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;starred&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;trashed&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">false</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">}</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;createdDate&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;2022-10-03T12:18:33.160Z&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;modifiedDate&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#7ec699">&quot;2022-10-03T12:29:36.221Z&quot;</span><span>,
</span><span>  </span><span class="token token" style="color:#7ec699">&quot;capabilities&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#ccc">{</span><span>
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canEdit&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canComment&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canAddChildren&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canDownload&quot;</span><span class="token token" style="color:#f8c555">:</span><span> true,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canRemoveChildren&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canRename&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveItemIntoTeamDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveItemOutOfDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveItemWithinDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> false,
</span><span>    </span><span class="token token" style="color:#7ec699">&quot;canMoveChildrenWithinDrive&quot;</span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">false</span><span>
</span><span>  </span><span class="token token" style="color:#ccc">}</span><span>
</span><span></span><span class="token token" style="color:#ccc">}</span><span>
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Creation </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:18:33 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span><span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Last edit </span><span class="token token" style="color:#f08d49">date</span><span> </span><span class="token token" style="color:#f8c555">:</span><span> </span><span class="token token" style="color:#f08d49">2022</span><span>/10/03 </span><span class="token token" style="color:#f08d49">12</span><span>:29:36 </span><span class="token token" style="color:#ccc">(</span><span>UTC</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>Public permissions </span><span class="token token" style="color:#f8c555">:</span><span>
</span>- reader
<!-- -->
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Owner found </span><span class="token token" style="color:#67cdcc">!</span><span>
</span>
<span>Name </span><span class="token token" style="color:#f8c555">:</span><span> my real name is secret
</span><span>Email </span><span class="token token" style="color:#f8c555">:</span><span> mpju40nchoyba85@gmail.com
</span><span>Google ID </span><span class="token token" style="color:#f8c555">:</span><span> 03458870179467391774
</span>
<span></span><span class="token token" style="color:#ccc">[</span><span>+</span><span class="token token" style="color:#ccc">]</span><span> Custom profile picture </span><span class="token token" style="color:#67cdcc">!</span><span>
</span><span></span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#67cdcc">&gt;</span><span> https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS</span><span class="token token" style="color:#67cdcc">=</span><span>s64
</span><span>Profile picture saved </span><span class="token token" style="color:#67cdcc">!</span></code></div></pre>
<p>Only <code class="undefined MarkdownRender_inlineCode__xySf4" node="[object Object]">doc</code> command is available with this token.</p></div><div class="x2b8uid">© 2021-<!-- -->2023<!-- --> SecHack365-Fans All Right Reserved.</div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"postData":{"id":"FlagDM","contentHtml":"# FlagDM\n\n## Phase 1 (Get Email)\n\nGoogle ドキュメントの URL が与えられます。Google ドキュメントには作成者に関するさまざまな情報が含まれています。その情報を知る手段として[GHunt](https://github.com/mxrch/GHunt)があります。しかし、GHunt は doc コマンドは[issue にも書かれている通り](https://github.com/mxrch/GHunt/issues/360)、一時的に使用できませんでした(勿論、現時点では使用できる可能性もあります)。\n\nそこで、ここでは[xeuledoc](https://github.com/Malfrats/xeuledoc)を使用します。これは GHunt と殆ど同じコードですが、[Google Internal token](https://github.com/Malfrats/xeuledoc/blob/master/xeuledoc/core.py#L37)の関係で GHunt を使用できない場合でも、こちらは使用できることがあります。\n\n```bash\n$ xeuledoc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\nTwitter : @MalfratsInd\nGithub : https://github.com/Malfrats/xeuledoc\n\nDocument ID : 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\n[+] Creation date : 2022/10/03 12:18:33 (UTC)\n[+] Last edit date : 2022/10/03 12:29:36 (UTC)\n\nPublic permissions :\n- reader\n\n[+] Owner found !\n\nName : my real name is secret\nEmail : mpju40nchoyba85@gmail.com\nGoogle ID : 03458870179467391774\n```\n\nこのように名前、Email、Google ID などが手に入りました。名前は偽名のようです。しかし、Email が手に入ったのでこれを使用します。\n\n## Phase 2 (Get Twitter)\n\n先ほどの GHunt を用いて、Email から Gaia ID を取得します。\n\n```bash\npython3 ghunt.py email mpju40nchoyba85@gmail.com\n\n     .d8888b.  888    888                   888\n    d88P  Y88b 888    888                   888\n    888    888 888    888                   888\n    888        8888888888 888  888 88888b.  888888\n    888  88888 888    888 888  888 888 \"88b 888\n    888    888 888    888 888  888 888  888 888\n    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.\n     \"Y8888P88 888    888  \"Y88888 888  888  \"Y888\n\n[+] 1 account found !\n\n------------------------------\n\nName : my real name is secret\n\n[+] Custom profile picture !\n=\u003e https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS\nProfile picture saved !\n\nLast profile edit : 2022/10/04 17:21:29 (UTC)\n\nEmail : mpju40nchoyba85@gmail.com\nGaia ID : 117114600888142762916\n\nHangouts Bot : No\n\n[-] Unable to fetch connected Google services.\n\n[-] YouTube channel not found.\n\nGoogle Maps : https://www.google.com/maps/contrib/117114600888142762916/reviews\n[-] No reviews\n\nGoogle Calendar : https://calendar.google.com/calendar/u/0/embed?src=mpju40nchoyba85@gmail.com\n[-] No public Google Calendar.\n```\n\n`Gaia ID : 117114600888142762916`と表記されています。また、この箇所に注目してください。\n\n```bash\nGoogle Maps : https://www.google.com/maps/contrib/117114600888142762916/reviews\n[-] No reviews\n```\n\nこの人は Google Map のレビューを投稿していないように見えます。しかし、実際には存在します。[こちら](https://www.google.com/maps/contrib/117114600888142762916/reviews)の「写真」をクリックしてみてください。表示しない設定においても、レビューの写真のみ表示されています。\n\n![review](./review.png)\n\nよく見ると権利表記の Twitter ID が表示されています。`@07xm8d9pzp`\n\n\u003chttps://twitter.com/07xm8d9pzp\u003e\n\nプロフィールに Youtube のチャンネルが記載されています。\n\n\u003chttps://www.youtube.com/channel/UCZ7_GtoaC4oHCKBLhJi13Ww\u003e\n\n`gross_poem`というユーザ名を使用していることがわかりました。\n\n## Phase 3 (Get Flag)\n\nこのユーザ名を用いて、使用している別のサービスを探します。これは、[sherlock](https://github.com/sherlock-project/sherlock)が非常に便利です。\n\n```bash\n$ python3 sherlock gross_poem\nUpdate Available!\nYou are running version 0.14.0. Version 0.14.2 is available at https://git.io/sherlock\n[*] Checking username gross_poem on:\n\n\n[+] Trakt: https://www.trakt.tv/users/gross_poem\n[+] koo: https://www.kooapp.com/profile/gross_poem\n[+] skyrock: https://gross_poem.skyrock.com/\n```\n\nこのうち、[Trakt](https://www.trakt.tv/users/gross_poem)を開くと明らかに怪しい Base64 の文字列が表示されています。\n\n`TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==`\n\nBase64 をデコードします。\n\n```bash\n$ echo \"TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==\" | base64 -d\nNice! Flag is Here! -\u003e TsukuCTF22{M4ny_0S1N7_700ls_3x157}\n```\n\n## Flag\n\n`TsukuCTF22{M4ny_0S1N7_700ls_3x157}`\n\n## Tips\n\n実は GHunt でも`resources/data.txt`の`internal`に xeuledoc のトークンを使用すると、正常に動作します。\n\n結果的に変更される箇所はここです。\n\n\u003chttps://github.com/mxrch/GHunt/blob/4601d75d6bb12c33a605a7ac5bf88e151e9ba3d3/modules/email.py#L46\u003e\n\n最終的な出力は以下のようになります。\n\n```bash\n$ python3 ghunt.py doc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\n     .d8888b.  888    888                   888\n    d88P  Y88b 888    888                   888\n    888    888 888    888                   888\n    888        8888888888 888  888 88888b.  888888\n    888  88888 888    888 888  888 888 \"88b 888\n    888    888 888    888 888  888 888  888 888\n    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.\n     \"Y8888P88 888    888  \"Y88888 888  888  \"Y888\n\n\nDocument ID : 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\n{\n  \"kind\": \"drive#file\",\n  \"userPermission\": {\n    \"id\": \"me\",\n    \"type\": \"user\",\n    \"role\": \"reader\"\n  },\n  \"parents\": [],\n  \"iconLink\": \"https://drive-thirdparty.googleusercontent.com/16/type/application/vnd.google-apps.document\",\n  \"shared\": true,\n  \"alternateLink\": \"https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg/edit?usp=drivesdk\",\n  \"fileSize\": \"31860\",\n  \"copyRequiresWriterPermission\": false,\n  \"permissions\": [\n    {\n      \"id\": \"anyoneWithLink\",\n      \"type\": \"anyone\",\n      \"role\": \"reader\",\n      \"withLink\": true\n    },\n    {\n      \"id\": \"03458870179467391774\",\n      \"name\": \"my real name is secret (gross_poem)\",\n      \"type\": \"user\",\n      \"role\": \"owner\",\n      \"photoLink\": \"https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS=s64\",\n      \"emailAddress\": \"mpju40nchoyba85@gmail.com\",\n      \"domain\": \"gmail.com\"\n    }\n  ],\n  \"id\": \"1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\",\n  \"labels\": {\n    \"starred\": false,\n    \"trashed\": false\n  },\n  \"createdDate\": \"2022-10-03T12:18:33.160Z\",\n  \"modifiedDate\": \"2022-10-03T12:29:36.221Z\",\n  \"capabilities\": {\n    \"canEdit\": false,\n    \"canComment\": false,\n    \"canAddChildren\": false,\n    \"canDownload\": true,\n    \"canRemoveChildren\": false,\n    \"canRename\": false,\n    \"canMoveItemIntoTeamDrive\": false,\n    \"canMoveItemOutOfDrive\": false,\n    \"canMoveItemWithinDrive\": false,\n    \"canMoveChildrenWithinDrive\": false\n  }\n}\n\n[+] Creation date : 2022/10/03 12:18:33 (UTC)\n[+] Last edit date : 2022/10/03 12:29:36 (UTC)\n\nPublic permissions :\n- reader\n\n[+] Owner found !\n\nName : my real name is secret\nEmail : mpju40nchoyba85@gmail.com\nGoogle ID : 03458870179467391774\n\n[+] Custom profile picture !\n=\u003e https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS=s64\nProfile picture saved !\n```\n\nしかし、このトークンでは doc コマンドしか使用する権限がありません。\n\n## Phase 1 (Get Email)\n\nGoogle Document URL is provided. Google docs contains many infos related to author. [GHunt](https://github.com/mxrch/GHunt) is a great tool to know those infos. However, GHunt doc command seems not available today according to an [issue](https://github.com/mxrch/GHunt/issues/360) (Of course, you may be able to use it now)\nSo in this write-up, we'll use [xeuledoc](https://github.com/Malfrats/xeuledoc). Even though this is similar to GHunt, we may be able to use this even though we can't run GHunt because of [Google Internal token](https://github.com/Malfrats/xeuledoc/blob/master/xeuledoc/core.py#L37)\n\n```bash\n$ xeuledoc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\nTwitter : @MalfratsInd\nGithub : https://github.com/Malfrats/xeuledoc\n\nDocument ID : 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\n[+] Creation date : 2022/10/03 12:18:33 (UTC)\n[+] Last edit date : 2022/10/03 12:29:36 (UTC)\n\nPublic permissions :\n- reader\n\n[+] Owner found !\n\nName : my real name is secret\nEmail : mpju40nchoyba85@gmail.com\nGoogle ID : 03458870179467391774\n```\n\nWe can get Name, Email, and Google ID. The name seems useless. However, we get an e-mail.\n\n## Phase 2 (Get Twitter)\n\nWith using GHunt, we can detect Gaia ID from Email.\n\n```bash\npython3 ghunt.py email mpju40nchoyba85@gmail.com\n\n     .d8888b.  888    888                   888\n    d88P  Y88b 888    888                   888\n    888    888 888    888                   888\n    888        8888888888 888  888 88888b.  888888\n    888  88888 888    888 888  888 888 \"88b 888\n    888    888 888    888 888  888 888  888 888\n    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.\n     \"Y8888P88 888    888  \"Y88888 888  888  \"Y888\n\n[+] 1 account found !\n\n------------------------------\n\nName : my real name is secret\n\n[+] Custom profile picture !\n=\u003e https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS\nProfile picture saved !\n\nLast profile edit : 2022/10/04 17:21:29 (UTC)\n\nEmail : mpju40nchoyba85@gmail.com\nGaia ID : 117114600888142762916\n\nHangouts Bot : No\n\n[-] Unable to fetch connected Google services.\n\n[-] YouTube channel not found.\n\nGoogle Maps : https://www.google.com/maps/contrib/117114600888142762916/reviews\n[-] No reviews\n\nGoogle Calendar : https://calendar.google.com/calendar/u/0/embed?src=mpju40nchoyba85@gmail.com\n[-] No public Google Calendar.\n```\n\nGHunt says `Gaia ID : 117114600888142762916`.\nAnd this person doesn't seem to provide any Google Map reviews as GHunt says\n\n```bash\nGoogle Maps : https://www.google.com/maps/contrib/117114600888142762916/reviews\n[-] No reviews\n```\n\nHowever, (s)he does! Let's click the photo(写真) tab in [this page](https://www.google.com/maps/contrib/117114600888142762916/reviews). Even though the review is set not to display, the photo is displayed.\n\n![review](./review.png)\n\nYou can find Twitter ID `@07xm8d9pzp` in the photo.\n\u003chttps://twitter.com/07xm8d9pzp\u003e\n\nAnd you'll find YouTube link in Twitter profile.\n\u003chttps://www.youtube.com/channel/UCZ7_GtoaC4oHCKBLhJi13Ww\u003e\n\nNow this person use `gross_poem` as his account name.\n\n## Phase 3 (Get Flag)\n\nDetect other services based on this user name. [sherlock](https://github.com/sherlock-project/sherlock) is a great tool to do this.\n\n```bash\n$ python3 sherlock gross_poem\nUpdate Available!\nYou are running version 0.14.0. Version 0.14.2 is available at https://git.io/sherlock\n[*] Checking username gross_poem on:\n\n\n[+] Trakt: https://www.trakt.tv/users/gross_poem\n[+] koo: https://www.kooapp.com/profile/gross_poem\n[+] skyrock: https://gross_poem.skyrock.com/\n```\n\nYou'll find a very strange Base64 string in [Trakt](https://www.trakt.tv/users/gross_poem)\n\n`TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==`\n\nDecode this string and you'll get the FLAG.\n\n```bash\n$ echo \"TmljZSEgRmxhZyBpcyBIZXJlISAtPiBUc3VrdUNURjIye000bnlfMFMxTjdfNzAwbHNfM3gxNTd9Cg==\" | base64 -d\nNice! Flag is Here! -\u003e TsukuCTF22{M4ny_0S1N7_700ls_3x157}\n```\n\n## Flag\n\n`TsukuCTF22{M4ny_0S1N7_700ls_3x157}`\n\n## Tips\n\nActually, GHunt works fine when you specify xeuledoc token at `internal` in `resources/data.txt`.\n\nThis will be modified\n\u003chttps://github.com/mxrch/GHunt/blob/4601d75d6bb12c33a605a7ac5bf88e151e9ba3d3/modules/email.py#L46\u003e\n\nAnd the result is following\n\n```bash\n$ python3 ghunt.py doc https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\n     .d8888b.  888    888                   888\n    d88P  Y88b 888    888                   888\n    888    888 888    888                   888\n    888        8888888888 888  888 88888b.  888888\n    888  88888 888    888 888  888 888 \"88b 888\n    888    888 888    888 888  888 888  888 888\n    Y88b  d88P 888    888 Y88b 888 888  888 Y88b.\n     \"Y8888P88 888    888  \"Y88888 888  888  \"Y888\n\n\nDocument ID : 1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\n\n{\n  \"kind\": \"drive#file\",\n  \"userPermission\": {\n    \"id\": \"me\",\n    \"type\": \"user\",\n    \"role\": \"reader\"\n  },\n  \"parents\": [],\n  \"iconLink\": \"https://drive-thirdparty.googleusercontent.com/16/type/application/vnd.google-apps.document\",\n  \"shared\": true,\n  \"alternateLink\": \"https://docs.google.com/document/d/1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg/edit?usp=drivesdk\",\n  \"fileSize\": \"31860\",\n  \"copyRequiresWriterPermission\": false,\n  \"permissions\": [\n    {\n      \"id\": \"anyoneWithLink\",\n      \"type\": \"anyone\",\n      \"role\": \"reader\",\n      \"withLink\": true\n    },\n    {\n      \"id\": \"03458870179467391774\",\n      \"name\": \"my real name is secret (gross_poem)\",\n      \"type\": \"user\",\n      \"role\": \"owner\",\n      \"photoLink\": \"https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS=s64\",\n      \"emailAddress\": \"mpju40nchoyba85@gmail.com\",\n      \"domain\": \"gmail.com\"\n    }\n  ],\n  \"id\": \"1y266JcI1E8piugLQDPaK7boSzAKykg4FepQZIOt4Phg\",\n  \"labels\": {\n    \"starred\": false,\n    \"trashed\": false\n  },\n  \"createdDate\": \"2022-10-03T12:18:33.160Z\",\n  \"modifiedDate\": \"2022-10-03T12:29:36.221Z\",\n  \"capabilities\": {\n    \"canEdit\": false,\n    \"canComment\": false,\n    \"canAddChildren\": false,\n    \"canDownload\": true,\n    \"canRemoveChildren\": false,\n    \"canRename\": false,\n    \"canMoveItemIntoTeamDrive\": false,\n    \"canMoveItemOutOfDrive\": false,\n    \"canMoveItemWithinDrive\": false,\n    \"canMoveChildrenWithinDrive\": false\n  }\n}\n\n[+] Creation date : 2022/10/03 12:18:33 (UTC)\n[+] Last edit date : 2022/10/03 12:29:36 (UTC)\n\nPublic permissions :\n- reader\n\n[+] Owner found !\n\nName : my real name is secret\nEmail : mpju40nchoyba85@gmail.com\nGoogle ID : 03458870179467391774\n\n[+] Custom profile picture !\n=\u003e https://lh3.googleusercontent.com/a-/ACNPEu_leXrOIIzCIna7Jx_LcstS9GGLCDF8HfbnQ-rS=s64\nProfile picture saved !\n```\n\nOnly `doc` command is available with this token.\n","title":"FlagDM","description":"架空請求書のDMから個人を特定します","author":"ryusei_ishika","genre":"OSINT","solver":7,"point":500}},"__N_SSG":true},"page":"/ctf/TsukuCTF2022/[id]","query":{"id":"FlagDM"},"buildId":"pGek_3YC8jk9kHJKsQkjz","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>