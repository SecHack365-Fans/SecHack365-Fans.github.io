{
    "componentChunkName": "component---src-templates-writeups-js",
    "path": "/ctf/writeups/CrackSSH/writeup/",
    "result": {"data":{"site":{"siteMetadata":{"title":"SecHack365-Fans HomePage"}},"markdownRemark":{"id":"d3d55ec8-1542-5205-8c5a-f648303f1675","excerpt":"CrackSSH! 調査対象のサーバーで使われている公開鍵を入手した。噂によると、この鍵には問題があるらしいが…。なんとかして侵入しなければ。 \n ※対象のポート以外はアクセスしないようにしてください。 不備があるRSA暗号を解読させる問題はCTF頻出ですが、私は20年以上生きていて n = ○○ やe = xx…","html":"<h1>CrackSSH!</h1>\n<blockquote>\n<p>調査対象のサーバーで使われている公開鍵を入手した。噂によると、この鍵には問題があるらしいが…。なんとかして侵入しなければ。</p>\n<p><code class=\"language-text\">Target: frt.hongo.wide.ad.jp</code>\n<code class=\"language-text\">Port: 30022</code></p>\n<p>※対象のポート以外はアクセスしないようにしてください。</p>\n</blockquote>\n<p>不備があるRSA暗号を解読させる問題はCTF頻出ですが、私は20年以上生きていて n = ○○ やe = xx という形でRSA暗号を扱ったことがありません。脆弱なRSA暗号を実際に解いてもらうことを目的として出題しました。</p>\n<h2>解法</h2>\n<p>公開鍵の先頭を見ると <code class=\"language-text\">ssh-rsa</code>と書かれているので、これがおそらくRSA暗号の公開鍵であることがわかります。ということは、この鍵の正体はnとeのはずです。また、鍵の末尾には<code class=\"language-text\">tsukushi@frt.hongo.wide.ad.jp</code>と書かれているので、この鍵の所有者が<code class=\"language-text\">tsukushi</code>であろうことも推定ができます。</p>\n<p>まず、この鍵が文字列のままではよくわからないので、ここからnとeを取り出します。<code class=\"language-text\">AAAA</code>から始まる鍵の本体をbase64でdecodeすると、公開鍵のフォーマットを定めた<a href=\"https://datatracker.ietf.org/doc/html/rfc4253\">RCF4253</a>に従うバイト列になるので、これをもとにnとeを計算します。\nあるいは単に<code class=\"language-text\">ssh-keygen -f crackssh.pub -e -m pem | openssl asn1parse</code>としてもよいです。</p>\n<p>n = 360925413365609656207284763303112593050686426607629131354843699618905677197872793512380288223361149508460688151102823348462592916817609977273908821217493993702786929282477487755465976082059834867631026295714550319202482180891845062064382568022072228888091051431136923983143306662931216184662445381040847666201\ne = 248940659700671391171916045022225211367167934215525303038734152650593067612113589541083076628705613883775652505492831370527586438096113903892713520850387855997035509546247913887222055672708066391999421835495881798128330308530099218984443115901043292942963247939575084326452874538239309850357410618060448737279\nであることがわかります。 eの値がとても大きいので、Wiener’s attackが可能なのではないか? と思えてきます。\nWiener’s attack は、RSA暗号の秘密鍵dの値が小さいときに成立する攻撃です。今回eが異常に大きいということは、相対的にdは小さいのではないかと期待できます。Wiener’s attackの実装はインターネットに落ちています。私は<a href=\"https://github.com/pablocelayes/rsa-wiener-attack%E3%82%92%E4%BD%BF%E3%82%8F%E3%81%9B%E3%81%A6%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8D%E3%81%BE%E3%81%97%E3%81%9F%E3%80%82%E3%81%93%E3%82%8C%E3%81%AB%E3%82%88%E3%82%8A%E3%80%81\">https://github.com/pablocelayes/rsa-wiener-attackを使わせていただきました。これにより、</a>\nd = 23740595481413555083001316385586537295798010164154043863363374388086679976575\nであるとわかります。</p>\n<p>これにて秘密鍵の情報が入手できたので、実際にsshが読めるカタチに鍵のフォーマットを整えていきます。\nRFCを見ながら頑張ってもいいですし、<a href=\"https://github.com/ius/rsatool.git%E3%81%A8%E3%81%8B%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%82%82%E3%81%84%E3%81%84%E3%81%A7%E3%81%99%E3%80%82\">https://github.com/ius/rsatool.gitとかを使ってもいいです。</a>\n最終的に鍵を作成したら、<code class=\"language-text\">ssh -i &lt;&lt;復元した秘密鍵>> -p 30022 tsukushi@frt.hongo.wide.ad.jp</code>とすることで、サーバーにログインできます。ログイン先には<code class=\"language-text\">flag.txt</code>が置かれており、この中身が答えです。</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">TsukuCTF{D0nt_use_w34k_RS4_key_generat10n}</code></pre></div>","frontmatter":{"title":"CrackSSH!","description":"脆弱なRSA鍵を解読する","author":"rikuta0811_dash","genre":"Crypto","solver":"13","point":"436"}}},"pageContext":{"id":"d3d55ec8-1542-5205-8c5a-f648303f1675"}},
    "staticQueryHashes": ["2841359383"]}